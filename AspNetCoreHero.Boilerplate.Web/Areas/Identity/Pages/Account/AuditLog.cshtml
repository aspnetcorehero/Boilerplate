@page
@model AspNetCoreHero.Boilerplate.Web.Areas.Identity.Pages.Account.AuditLogModel

@{
    ViewData["Title"] = localizer.GetLocalizedHtmlString("Audit Log");
    ViewData["Caption"] = localizer.GetLocalizedHtmlString("View your Recent 250 Logs here");
}
@inject AspNetCoreHero.Boilerplate.Web.Services.SharedResourceLocalizer localizer;
<div class="card">
    <div id="viewAll" class="card-body table-responsive">
        <table class="table table-striped" id="logTable">
            <thead>
                <tr>
                    <th>
                        @localizer.GetLocalizedHtmlString("Id")
                    </th>
                    <th>
                        @localizer.GetLocalizedHtmlString("Date")
                    </th>
                    <th>
                        @localizer.GetLocalizedHtmlString("Action")
                    </th>
                    <th>
                        @localizer.GetLocalizedHtmlString("Module")
                    </th>
                    <th>
                        @localizer.GetLocalizedHtmlString("Key")
                    </th>
                    <th>
                        @localizer.GetLocalizedHtmlString("Affected Columns")
                    </th>
                    <th>
                        @localizer.GetLocalizedHtmlString("Old Values")
                    </th>
                    <th>
                        @localizer.GetLocalizedHtmlString("New Values")
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model.AuditLogResponses)
                {
                <tr>
                    <td>
                        @user.Id
                    </td>
                    <td>
                        <a>
                            <small class="badge badge-warning"><i class="far fa-clock"></i> Universal</small> @user.DateTime.ToString("dd/MM/yyyy h:mm:ss tt")
                        </a>
                        <br>
                        <small>

                            @{
                                DateTime runtimeKnowsThisIsUtc = DateTime.SpecifyKind(user.DateTime, DateTimeKind.Utc);
                                DateTime localVersion = runtimeKnowsThisIsUtc.ToLocalTime();
                            }
                            <small class="badge badge-success"><i class="far fa-clock"></i> Local</small> @localVersion.ToString("dd/MM/yyyy h:mm:ss tt")
                        </small>
                    </td>
                    <td>
                        @user.Type
                    </td>
                    <td>
                        @user.TableName
                    </td>
                    <td>
                        @user.PrimaryKey
                    </td>
                    <td>
                        @user.AffectedColumns
                    </td>
                    <td>
                        @user.OldValues
                    </td>
                    <td>
                        @user.NewValues
                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>
</div>
@section Scripts
{
    <script src="~/js/site.js"></script>
    <script>
        $(document).ready(function () {
            $("#logTable").DataTable({

                "order": [[0, "desc"]]
            });
        });
    </script>
}